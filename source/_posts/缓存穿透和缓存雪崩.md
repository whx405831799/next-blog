title: 缓存穿透和缓存雪崩
date: 2017/04/01 15:36:56
categories:
- 缓存
tags:
- 缓存穿透
---

## 1.缓存穿透
### 1.1 什么是缓存穿透
使用缓存时，一次请求数据，会先先检查缓存中是否存在此数据，如果存在直接返回缓存的数据，如果不存在就回去查询数据库然后再缓存查询结果并返回。如果查询的某个数据在缓存中一直不存在，就会造成每一次请求都查询DB（数据库），这样就会一直穿透缓存，在流量特别大时，数据库就有可能崩溃。
### 1.2 如何解决缓存穿透
- 如果查询数据库也没有值，则直接设置一个默认值存存到缓存，这样第二次到缓存中获取就有值了。
- 布隆过滤器，将所有可能存在的数据哈希到一个足够大的BitSet中，不存在的数据将会被拦截掉，从而避免了对底层存储系统的查询压力。
- 

## 2.缓存雪崩
### 2.1 什么是缓存雪崩
缓存雪崩大多数情况是是因为缓存同一时间大规模的失效，从而所有请求都去查询数据库，导致数据库CPU和内存负载过高，甚至会宕机。
### 2.2 如何解决缓存雪崩
- 分析用户行为，尽量让失效时间点均匀分布。避免同时失效。
- 如果是因为缓存服务器宕机，可以考虑做redis主从。


## 3.缓存预热
缓存预热是指系统上线前，将数据加载到缓存中。